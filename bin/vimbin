#!/usr/bin/env perl

use strict;
use warnings;

use File::Which qw( which );
use File::Temp qw( tempfile );

my @cleanup = ();
my @argv = map { /^-/ ? $_ : cook( $_ ) } @ARGV;

system $ENV{EDITOR} || 'vim', @argv;
$_->() for @cleanup;

sub cook {
  my $file = shift;
  my $exe = which( $file ) or return $file;
  if ( -B $exe ) {
    my ( undef, $hex ) = tempfile;
    push @cleanup, sub { unlink $hex };
    system "hexdump -C $exe > $hex";
    return $hex;
  }
  return $exe;
}
