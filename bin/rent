#!/usr/bin/env perl

use strict;
use warnings;
use File::Spec;

use constant SVN => '/opt/local/bin/svn';

renumber( shift || 't' );

sub renumber {
    my $dir = shift;
    opendir my $dh, $dir or die "Can't read $dir\n";
    my @files = grep { /^[^.]/ } readdir $dh;
    closedir $dh;

    my $next = 0;
    for my $f ( sort @files ) {
        next unless $f =~ /^(\d+)(.*)$/;
        my $new_name = sprintf( "%03d%s", 10 * $next++, $2 );
        if ( $f ne $new_name ) {
            my @cmd = (
                SVN, 'mv',
                File::Spec->catfile( $dir, $f ),
                File::Spec->catfile( $dir, $new_name )
            );
            print join(' ', @cmd), "\n";
        }
    }
}
