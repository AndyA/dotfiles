#!/bin/bash

FFMPEG=$(which ffmpeg)

[ -z $BITRATE   ] && BITRATE=3500000
[ -z $FRAMERATE ] && FRAMERATE=25

echo "ffmpeg:      $FFMPEG"
echo "bitrate:     $BITRATE"
echo "framerate:   $FRAMERATE"
echo "extension:   $EXT"

for INFILE in "$@"; do
  OUTFILE="$(dirname "$INFILE")/proxy/$(basename "$INFILE")"
  set -x
  mkdir -p "$(dirname "$OUTFILE")"
  $FFMPEG -y -i "$INFILE" \
    -acodec libfaac -ab 192k \
    -vcodec libx264 -b $BITRATE -r $FRAMERATE \
    -threads 0 "$OUTFILE"
  set +x
done

# vim:ts=2:sw=2:sts=2:et:ft=sh
