#!/usr/bin/env perl

use strict;
use warnings;
use Net::TcpDumpLog;
use Data::Hexdumper;

for my $df ( @ARGV ) {
  hdump( $df );
}

sub hdump {
  my $file = shift;

  my $log = Net::TcpDumpLog->new();
  $log->read( $file );

  for my $index ( $log->indexes ) {
    my ( $length_orig, $length_incl, $drops, $secs, $msecs )
      = $log->header( $index );
    my $data = $log->data( $index );
    print "=== $index ===\n";
    print hexdump( data => $data, space_as_space => 1 );
  }
}

# vim:ts=2:sw=2:sts=2:et:ft=perl
